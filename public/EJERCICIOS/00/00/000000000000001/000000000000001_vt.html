<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="stylesheet" href="bootstrap-grid.css">
	<title>00000_vt</title>
	<style>
		@font-face {
			font-family: 'varela';
			src: url('fonts/VarelaRound-Regular-webfont.woff');
		}

		@font-face {
			font-family: 'opensans';
			src: url('fonts/OpenSans-Regular-webfont.woff');
		}

		body {
			margin: 0;
		}

		p {
			font-family: 'opensans';
			font-size: 18px;
			margin: 5px 0;
		}

		header {
			width: 100%;
			height: 50px;
			margin-bottom: 10px;
		}

		section {
			width: 100%;
			max-height: calc(100vh - 120px); /* header 50 height + 10 m-b + footer 60px  */
			overflow-y: scroll;
		}

		section::-webkit-scrollbar {
			width: 5px;
		}
		
		section::-webkit-scrollbar-track {
			color: transparent;
		}
		
		section::-webkit-scrollbar-thumb {
			background: rgba(0, 0, 0, 0.4);
			border-radius: 10px;
		}
		
		section::-webkit-scrollbar-thumb:hover {
			background: rgba(0, 0, 0, 0.6); 
		}

		table img {
  			margin: 0;
		}

		.lineasbarra {
			display: flex;
			align-items: center;
			align-content: center;
			padding: 0 50px;
			height: 50px;
		}

		.lineasbarra hr {
			height: 1px;
			border: 0;
			color: #E7E5E5;
			background-color: #E7E5E5;
			width: calc(100% / 2 - 150px);
			display: none;
		}

		.opcionradio {
			display: flex;
			background-color: transparent;
			color: #3c3c3c;
			font-family: 'opensans';
			font-size: 20px;
			height: 100%;
			padding: 8px 0;
		}

		.opcionradio input[type=radio] {
			display: none;
		}

		.opcionradio input[type=radio] + label {
			padding: 8px 12px;
			border-radius: 40px;
			width: 100%;
		}

		.opcionradio input[type=radio] + label:before {
			height: 20px;
			width: 20px;
			border: 2px solid #bfbfbf;
			border-radius: 50%;
			margin-right: 4px;
			margin-top: 3px;
			margin-bottom: -4px;
			content: " ";
			display: inline-block;
			background-color: #fff;
			transition: 0.3s;
			cursor: pointer;
		}

		.opcionradio input[type=radio]:checked + label:before {
			border: 2px solid #1caff6;
			background: #1caff6;
		}

		.opcionradio input[type=radio]:checked + label {
			background: #b9e8ff;
			color: #1caff6;
			padding: 8px 12px;
		}

		.opcionradio label {
			cursor: pointer;
		}

		/* INICIO DISEÑO TABLAS SIMPLES */

		.tabla {
			width: 100%;
		}

		.tabla td {
			font-size: 20px;
			color: #000000;
			text-align: center; 
			vertical-align: middle;
			padding: 5px;
		}

		.tabla p {
			margin-bottom: 0;
		}

		.tabla input {
			min-width: 40px;
			max-height:  50px;
			border: 2px solid #cfcfcf;
			border-radius: 8px;
			padding: 5px;
			background: transparent;
			font-size: 20px;
			color: #000000;
		}

		.inputTexto-correcto {
			border: 2px solid #BFF199 !important;
			color: #BFF199 !important;
		}

		.inputTexto-incorrecto {
			border: 2px solid #F6B3B1 !important;
			color: #F6B3B1 !important;
		}

		.tabla input:focus {
			border-color: #1cb0f6;
		}

		.tabla-bordes {
			border-collapse: separate;
			border-spacing: 0;
		}

		.tabla-bordes td {
			border-right: 2px solid #107dac;
			border-bottom: 2px solid #107dac;
		}

		.tabla-bordes tr td:first-child {
			border-left: 2px solid #107dac;
		}

		.tabla-bordes tr:first-child td {
			border-top: 2px solid #107dac;
		}

		/* top-left border-radius */
		.tabla-bordes tr:first-child td:first-child {
			border-top-left-radius: 10px;
		}

		/* top-right border-radius */
		.tabla-bordes tr:first-child td:last-child {
			border-top-right-radius: 10px;
		}

		/* bottom-left border-radius */
		.tabla-bordes tr:last-child td:first-child {
			border-bottom-left-radius: 10px;
		}

		/* bottom-right border-radius */
		.tabla-bordes tr:last-child td:last-child {
			border-bottom-right-radius: 10px;
		}

		/* TERMINO DISEÑO TABLAS SIMPLES */

		

		/* FOOTER STYLESS */

		footer {
			position: fixed;
			right: 0;
			bottom: 0;
			left: 0;
			z-index: 1030;
			background-color: white;
			width: 100%;
			height: 60px;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		.bton {
			font-family: 'varela';
			font-size: 16px;
			position: relative;
			width: 100%;
			border-radius: 19px;
			height: 40px;
		}

		.icon-consulta span {
			display: block;
			content: url("imgs/general/open-book.svg");
			margin: 0 auto;
			height: 100%;
			width: auto;
		}

		.icon-responder span {
			display: block;
			content: url("imgs/general/flecha-der.svg");
			margin: 0 auto;
			height: 85%;
			width: auto;
		}

		.bton:not(:disabled) {
			cursor: pointer;
		}

		#btnConsulta {
			background-color: #FFF;
			border: 2px solid #bfbfbf;
			color: #107dac;
		}

		#btnConsulta:hover {
			border-color: #1caff6;
			background-color: transparent;
		}

		#btnConsulta:disabled {
			background: #e6e6e6;
			color:#FFF;
			cursor: default;
			border: none;
		}

		#btnResponder {
			background: #1a8dc6;
			color: #FFF;
			border: none;
		}

		#btnResponder:hover {
			background-color: #107dac;
		}

		#btnResponder:disabled {
			background-color: #e6e6e6;
			color: #3c3c3c;
		}

		#btnResponder.respCorrecta {
			background-color: #4d8b4b;
		}

		#btnResponder.respIncorrecta {
			background-color: #d33131;
		}

		@media (min-width: 576px) {/* sm */
			.lineasbarra hr {
				display: block;
			}
		}

		@media (min-width: 768px) {/* md */
			header {
				margin-bottom: 20px;
			}

			section {
				height: calc(100vh - 170px); /* header 50 height + 20 m-b + footer 100px  */
			}

			footer {
				height: 100px;
			}

			.bton {
				border-radius: 26px;
    			height: 53px;
			}

			.bton-5 {
				overflow: hidden;
				backface-visibility: hidden;
			}

			button:not(:disabled).bton-5 span {
				display: inline-block;
				-webkit-transition: all 0.8s;
				-webkit-backface-visibility: hidden;
				-moz-transition: all 0.8s;
				-moz-backface-visibility: hidden;
				transition: all 1s;
				backface-visibility: hidden;
			}

			button:not(:disabled).bton-5:before {
				position: absolute;
				height: 100%;
				line-height: 3;
				font-size: 180%;
				-moz-transition: all 0.3s;
				transition: all 1s;
			}

			button:not(:disabled).bton-5:active:before {
				color: #703b87;
			}

			button:not(:disabled).bton-5a:hover span {
				-webkit-transform: translateY(300%);
				-moz-transform: translateY(300%);
				-ms-transform: translateY(300%);
				transform: translateY(200%);
			}

			button:not(:disabled).bton-5a:before {
				top: -115%;
			}

			button:not(:disabled).bton-5a:hover:before {
				top: -4px;
			}

			button:not(:disabled).icon-consulta:before {
				content: url("imgs/general/open-book.svg");
				width: 42px;
				margin-left: auto;
				margin-right: auto;
				left: 0;
				right: 0;
			}

			button:not(:disabled).icon-responder:before {
				content: url("imgs/general/flecha-der.svg");
				width: 36px;
				margin-left: auto;
				margin-right: auto;
				left: 0;
				right: 0;
			}
		}

		@media (min-width: 992px) {/* lg */

		}

		@media (min-width: 1200px) {/* xl */

		}
	</style>
</head>

<body id="000000000000000">
	<header>
		<div class="lineasbarra">
			<hr>
			<svg xmlns="http://www.w3.org/2000/svg" id="progressbar" height="36" width="254" version="1.1"></svg>
			<hr>
		</div>
	</header>
	<section class="contenido">
		<div class="container-fluid">
			<div id="enunciado" class="row">
				<div class="col-md-12 col-sm-12 col-12 tag">
					<div id="container-e0">
						<p>Este es el enunciado del ejercicio seguido de una imágen</p>
					</div>
				</div>
				<div class="col-md-12 col-sm-12 col-12 tag">
					<img class="img-fluid mx-auto d-block" src="imgs/abaco.png" height="200" width="200" />
				</div>
				<div class="col-md-12 col-sm-12 col-12 tag">
					<div id="container-e2">
						<p>Selecciona la respuesta correcta</p>
					</div>
				</div>
			</div>
			<div id="respuesta" class="row justify-content-center">
				<div class="col-md-12 col-sm-12 col-xs-12 tag">
					<div id="container-r0" class="row justify-content-center">
						<div class="col-12 col-sm-6 col-md-3">
							<div class="opcionradio">
								<input type="radio" id="radio-0" name="answer" value="2" />
								<label for="radio-0">2</label>
							</div>
						</div>
						<div class="col-12 col-sm-6 col-md-3">
							<div class="opcionradio">
								<input type="radio" id="radio-1" name="answer" value="1" />
								<label for="radio-1">1</label>
							</div>
						</div>
						<div class="col-12 col-sm-6 col-md-3">
							<div class="opcionradio">
								<input type="radio" id="radio-2" name="answer" value="3" />
								<label for="radio-2">3</label>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<footer>
		<div class="container-fluid">
			<div class="row align-items-center">
				<div class="col-4 col-md-3">
					<button type="button" id="btnConsulta" class="bton bton-5 bton-5a icon-consulta"
						onclick="pressConsulta()">
						<span></span>
					</button>
					<img id="imgfeedback" class="img-fluid d-none" alt="IMG">
				</div>
				<div class="col-4 col-md-6"></div>
				<div class="col-4 col-md-3">
					<button type="button" id="btnResponder"
						class="bton bton-5 bton-5a icon-responder float-right" disabled>
						<span></span>
					</button>
				</div>
			</div>
		</div>
	</footer>
	<input id="hiddenIntento" type="hidden" value="hiddenIntento" onchange="cambio(this)">
	<script>
		let validaciones = `[{
  "valor": "1",
  "feedback": "¡Muy Bien!",
  "errFrec": null
},{
  "valor": "2",
  "feedback": "El primer factor no experimentó ninguna variación.",
  "errFrec": "2"
},{
  "valor": "3",
  "feedback": "El segundo factor no experimentó ninguna variación.",
  "errFrec": "3"
}]`
		let btnResponder = document.getElementById('btnResponder'),
			intento = 0,
			tmpProgreso,
			tmpTotal,
			hiddenBarraDatos = window.parent.parent.barraProgreso;

		if (hiddenBarraDatos) {
			let datosBarraDeProgreso = JSON.parse(hiddenBarraDatos.value);
			tmpProgreso = datosBarraDeProgreso.tmpProgreso ?
				datosBarraDeProgreso.tmpProgreso : [];
			tmpTotal = datosBarraDeProgreso.tmpTotal ?
				Number(datosBarraDeProgreso.tmpTotal) : 0;
		} else {
			tmpProgreso = localStorage.getItem('tmpProgreso') ?
				JSON.parse(localStorage.getItem('tmpProgreso')) : [];
			tmpTotal = localStorage.getItem('tmpTotal') ?
				Number(localStorage.getItem('tmpTotal')) : 0;
		}

		barraDeProgreso()

		function barraDeProgreso() {
			let anchoBarra = 250;//254 para el espacio del margen
			let svg = document.getElementById('progressbar');
			let separacion = anchoBarra / (tmpTotal + 1);

			let bordeBarra = crearElemento('rect', {
				x: 2,
				y: 2,
				width: anchoBarra,
				height: 32,
				fill: 'none',
				stroke: '#CCCBCB',
				strokeWidth: '1',
				rx: 5,
				ry: 5
			});
			svg.appendChild(bordeBarra);

			let anchoLinea = Number(anchoBarra - (separacion * 2));
			let lineaBarra = crearElemento('rect', {
				x: separacion,
				y: 17,
				width: anchoLinea,
				height: 2,
				fill: '#E7E5E5',
				rx: 2,
				ry: 2
			});
			svg.appendChild(lineaBarra);

			for (let i = 0; i < tmpTotal; i++) {
				let colorCirculo, rCircle;
				if (tmpProgreso.length > i) {
					rCircle = 4;
					if (tmpProgreso[i].correcto) {
						colorCirculo = tmpProgreso[i].NUMEROINTENTOS === 1 ? '#00AC4D' : '#E2C04D';
					} else {
						colorCirculo = '#E24B4A';
					}
				} else if (tmpProgreso.length === i) {
					rCircle = 8;
					colorCirculo = '#1280B1';
				} else {
					rCircle = 4;
					colorCirculo = '#CCCBCB';
				}
				let cxCircle = separacion * (i + 1) + 2;
				let circle = crearElemento('circle', {
					cx: cxCircle,
					cy: 18,
					r: rCircle,
					fill: colorCirculo,
					stroke: 'none'
				});
				svg.appendChild(circle);
				if (tmpProgreso.length === i) {
					let textPosicion = crearElemento('text', {
						x: cxCircle,
						y: 22,
						fontFamily: 'sans-serif',
						fontSize: '11px',
						textAnchor: 'middle',
						fill: 'white'
					});
					textPosicion.textContent = tmpProgreso.length + 1;
					svg.appendChild(textPosicion);
				}
			}

			function crearElemento(nombre, atributos) {
				let element = document.createElementNS("http://www.w3.org/2000/svg", nombre);
				for (let p in atributos) {
					element.setAttributeNS(null, p.replace(/[A-Z]/g, function (m, p, o, s) {
						return "-" + m.toLowerCase();
					}), atributos[p]);
				}
				return element;
			}
		}

		function changeInput(event) {
			if (event.target.type === 'radio') {
				if (btnResponder.disabled === true) {
					btnResponder.disabled = false
				}
			} else {

			}
		}

		function b64_to_utf8(str) {
			return decodeURIComponent(escape(window.atob(str)));
		}

		function responder(event) {
			let resultado = validaRespuesta()
			console.log(resultado)
			intento++
		}

		function validaRespuesta() {
			let vals = JSON.parse(validaciones)
			try {
				let resultado = null
				let respuesta = document.querySelector('input[name=answer]:checked').value || Array.from(document.querySelectorAll('input[name=answer]'))
				if (Array.isArray(respuesta)) {
					console.log('es input de texto', respuesta)
				} else {
					for (let i = 0; i < vals.length; i++) {
						if (respuesta === vals[i].valor) {
							resultado = {
								correcto: vals[i].errFrec ? 0 : 1,
								feedback: vals[i].feedback,
								errFrec: vals[i].errFrec
							}
						}
					}
				}
				return resultado
			} catch (e) {
				console.log(e)
			} finally {
				delete vals
			}
		}

		window.onload = function () {
			document.getElementsByName('answer').forEach(function (element) {
				element.addEventListener('change', changeInput)
			})
			btnResponder.addEventListener('click', responder)
		}
	</script>

</body>

</html>